{"ast":null,"code":"var _jsxFileName = \"D:\\\\pdf demo\\\\frontend\\\\src\\\\components\\\\DrawingTools.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { useMutation, useQueryClient } from 'react-query';\nimport { drawingAPI } from '../services/api';\nimport { Pen, ArrowRight, Square, Circle, Minus, Palette, X } from 'lucide-react';\nimport { v4 as uuidv4 } from 'uuid';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DrawingTools = ({\n  pdfUuid,\n  pageNumber,\n  scale,\n  isEnabled,\n  onDrawingChange,\n  pageContainerRef,\n  drawingOverlayRef\n}) => {\n  _s();\n  const [tool, setTool] = useState('freehand');\n  const [color, setColor] = useState('#ff0000');\n  const [strokeWidth, setStrokeWidth] = useState(2);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [currentPath, setCurrentPath] = useState([]);\n  const [showTools, setShowTools] = useState(true);\n  const svgRef = useRef(null);\n  const queryClient = useQueryClient();\n  const isDrawingRef = useRef(false);\n  const startPosRef = useRef(null);\n  const createDrawingMutation = useMutation(drawingAPI.create, {\n    onMutate: () => {\n      console.log('üé® Starting drawing mutation...');\n    },\n    onSuccess: data => {\n      console.log('‚úÖ Drawing saved successfully:', data);\n      queryClient.invalidateQueries(['drawings', pdfUuid]);\n      toast.success('Drawing saved!');\n    },\n    onError: error => {\n      var _error$response, _error$response$data;\n      console.error('‚ùå Failed to save drawing:', error);\n      toast.error('Failed to save drawing: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message));\n    }\n  });\n  const tools = [{\n    id: 'freehand',\n    icon: Pen,\n    name: 'Freehand'\n  }, {\n    id: 'arrow',\n    icon: ArrowRight,\n    name: 'Arrow'\n  }, {\n    id: 'rectangle',\n    icon: Square,\n    name: 'Rectangle'\n  }, {\n    id: 'circle',\n    icon: Circle,\n    name: 'Circle'\n  }, {\n    id: 'line',\n    icon: Minus,\n    name: 'Line'\n  }];\n  const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#000000'];\n  const getDrawingOverlay = useCallback(() => {\n    if (!(drawingOverlayRef !== null && drawingOverlayRef !== void 0 && drawingOverlayRef.current)) {\n      console.log('‚ùå No drawing overlay ref');\n      return null;\n    }\n    return drawingOverlayRef.current;\n  }, [drawingOverlayRef]);\n  const getRelativePosition = useCallback(e => {\n    const overlay = getDrawingOverlay();\n    if (!overlay) return {\n      x: 0,\n      y: 0\n    };\n    const rect = overlay.getBoundingClientRect();\n    const x = (e.clientX - rect.left) / rect.width;\n    const y = (e.clientY - rect.top) / rect.height;\n    const clampedPos = {\n      x: Math.max(0, Math.min(1, x)),\n      y: Math.max(0, Math.min(1, y))\n    };\n    console.log('üìç Position:', {\n      client: {\n        x: e.clientX,\n        y: e.clientY\n      },\n      rect: {\n        left: rect.left,\n        top: rect.top,\n        width: rect.width,\n        height: rect.height\n      },\n      relative: {\n        x,\n        y\n      },\n      clamped: clampedPos\n    });\n    return clampedPos;\n  }, [getDrawingOverlay]);\n  const handleMouseDown = useCallback(e => {\n    if (!isEnabled) {\n      console.log('‚ùå Drawing not enabled');\n      return;\n    }\n    console.log('üñ±Ô∏è Mouse down - starting drawing', {\n      tool,\n      enabled: isEnabled\n    });\n    e.preventDefault();\n    e.stopPropagation();\n    isDrawingRef.current = true;\n    setIsDrawing(true);\n    const pos = getRelativePosition(e);\n    startPosRef.current = pos;\n    setCurrentPath([pos]);\n    console.log('üé® Started drawing with position:', pos);\n  }, [isEnabled, getRelativePosition, tool]);\n  const handleMouseMove = useCallback(e => {\n    if (!isDrawingRef.current || !isEnabled) return;\n    e.preventDefault();\n    e.stopPropagation();\n    const pos = getRelativePosition(e);\n    if (tool === 'freehand') {\n      setCurrentPath(prev => {\n        const newPath = [...prev, pos];\n        console.log('‚úèÔ∏è Freehand path update, length:', newPath.length);\n        return newPath;\n      });\n    } else {\n      // For shapes, only keep start and current position\n      setCurrentPath([startPosRef.current, pos]);\n    }\n  }, [isEnabled, tool, getRelativePosition]);\n  const handleMouseUp = useCallback(async e => {\n    console.log('üñ±Ô∏è Mouse up triggered', {\n      isDrawing: isDrawingRef.current,\n      pathLength: currentPath.length,\n      tool\n    });\n    if (!isDrawingRef.current || currentPath.length === 0) {\n      console.log('‚ùå Not drawing or no path');\n      isDrawingRef.current = false;\n      setIsDrawing(false);\n      setCurrentPath([]);\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n\n    // Validate path based on tool\n    let validPath = [...currentPath];\n    if (tool !== 'freehand' && validPath.length > 2) {\n      validPath = [validPath[0], validPath[validPath.length - 1]];\n    }\n    console.log('üîç Validating path:', {\n      originalLength: currentPath.length,\n      validLength: validPath.length,\n      tool,\n      validPath\n    });\n    if (validPath.length < 2) {\n      console.log('‚ùå Path too short, canceling');\n      toast.error('Drawing too short - please draw a longer line');\n      isDrawingRef.current = false;\n      setIsDrawing(false);\n      setCurrentPath([]);\n      return;\n    }\n    const drawingData = {\n      uuid: uuidv4(),\n      pdfUuid,\n      pageNumber,\n      type: tool,\n      data: {\n        path: validPath,\n        scale\n      },\n      style: {\n        color,\n        strokeWidth,\n        opacity: 1\n      }\n    };\n    console.log('üíæ Attempting to save drawing:', drawingData);\n    try {\n      await createDrawingMutation.mutateAsync(drawingData);\n      onDrawingChange && onDrawingChange(drawingData);\n      console.log('‚úÖ Drawing save initiated successfully');\n    } catch (error) {\n      console.error('‚ùå Failed to save drawing:', error);\n    } finally {\n      isDrawingRef.current = false;\n      setIsDrawing(false);\n      setCurrentPath([]);\n      startPosRef.current = null;\n    }\n  }, [currentPath, tool, pdfUuid, pageNumber, scale, color, strokeWidth, createDrawingMutation, onDrawingChange]);\n\n  // Add event listeners to the drawing overlay\n  useEffect(() => {\n    if (!isEnabled) {\n      console.log('‚ùå Drawing not enabled, skipping event listeners');\n      return;\n    }\n    const overlay = getDrawingOverlay();\n    if (!overlay) {\n      console.log('‚ùå No overlay found, cannot add event listeners');\n      return;\n    }\n    console.log('üéØ Adding event listeners to drawing overlay');\n    overlay.addEventListener('mousedown', handleMouseDown, {\n      passive: false\n    });\n    overlay.addEventListener('mousemove', handleMouseMove, {\n      passive: false\n    });\n    overlay.addEventListener('mouseup', handleMouseUp, {\n      passive: false\n    });\n\n    // Global mouse up to handle dragging outside overlay\n    document.addEventListener('mouseup', handleMouseUp, {\n      passive: false\n    });\n    return () => {\n      console.log('üßπ Removing event listeners');\n      overlay.removeEventListener('mousedown', handleMouseDown);\n      overlay.removeEventListener('mousemove', handleMouseMove);\n      overlay.removeEventListener('mouseup', handleMouseUp);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isEnabled, handleMouseDown, handleMouseMove, handleMouseUp, getDrawingOverlay]);\n  const renderCurrentDrawing = () => {\n    if (currentPath.length === 0) return null;\n    const overlay = getDrawingOverlay();\n    if (!overlay) return null;\n    const rect = overlay.getBoundingClientRect();\n    switch (tool) {\n      case 'freehand':\n        if (currentPath.length < 2) return null;\n        const pathData = `M ${currentPath[0].x * rect.width} ${currentPath[0].y * rect.height} ` + currentPath.slice(1).map(p => `L ${p.x * rect.width} ${p.y * rect.height}`).join(' ');\n        return /*#__PURE__*/_jsxDEV(\"path\", {\n          d: pathData,\n          stroke: color,\n          strokeWidth: strokeWidth,\n          fill: \"none\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this);\n      case 'line':\n        if (currentPath.length < 2) return null;\n        return /*#__PURE__*/_jsxDEV(\"line\", {\n          x1: currentPath[0].x * rect.width,\n          y1: currentPath[0].y * rect.height,\n          x2: currentPath[currentPath.length - 1].x * rect.width,\n          y2: currentPath[currentPath.length - 1].y * rect.height,\n          stroke: color,\n          strokeWidth: strokeWidth\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 11\n        }, this);\n      case 'rectangle':\n        if (currentPath.length < 2) return null;\n        const last = currentPath[currentPath.length - 1];\n        const rectData = {\n          x: Math.min(currentPath[0].x, last.x) * rect.width,\n          y: Math.min(currentPath[0].y, last.y) * rect.height,\n          width: Math.abs(last.x - currentPath[0].x) * rect.width,\n          height: Math.abs(last.y - currentPath[0].y) * rect.height\n        };\n        return /*#__PURE__*/_jsxDEV(\"rect\", {\n          x: rectData.x,\n          y: rectData.y,\n          width: rectData.width,\n          height: rectData.height,\n          stroke: color,\n          strokeWidth: strokeWidth,\n          fill: \"none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this);\n      case 'circle':\n        if (currentPath.length < 2) return null;\n        const lastPos = currentPath[currentPath.length - 1];\n        const radius = Math.sqrt(Math.pow((lastPos.x - currentPath[0].x) * rect.width, 2) + Math.pow((lastPos.y - currentPath[0].y) * rect.height, 2));\n        return /*#__PURE__*/_jsxDEV(\"circle\", {\n          cx: currentPath[0].x * rect.width,\n          cy: currentPath[0].y * rect.height,\n          r: radius,\n          stroke: color,\n          strokeWidth: strokeWidth,\n          fill: \"none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 287,\n          columnNumber: 11\n        }, this);\n      case 'arrow':\n        if (currentPath.length < 2) return null;\n        const start = currentPath[0];\n        const end = currentPath[currentPath.length - 1];\n        const angle = Math.atan2((end.y - start.y) * rect.height, (end.x - start.x) * rect.width);\n        const arrowLength = 15;\n        const arrowAngle = Math.PI / 6;\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: start.x * rect.width,\n            y1: start.y * rect.height,\n            x2: end.x * rect.width,\n            y2: end.y * rect.height,\n            stroke: color,\n            strokeWidth: strokeWidth\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            d: `M ${end.x * rect.width} ${end.y * rect.height} \n                  L ${end.x * rect.width - arrowLength * Math.cos(angle - arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle - arrowAngle)}\n                  M ${end.x * rect.width} ${end.y * rect.height}\n                  L ${end.x * rect.width - arrowLength * Math.cos(angle + arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle + arrowAngle)}`,\n            stroke: color,\n            strokeWidth: strokeWidth,\n            fill: \"none\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n  if (!isEnabled) return null;\n  const overlay = getDrawingOverlay();\n  const overlayRect = overlay === null || overlay === void 0 ? void 0 : overlay.getBoundingClientRect();\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-4 z-50 transition-transform ${showTools ? '' : '-translate-x-full'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium\",\n            children: \"Drawing Tools\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowTools(false),\n            className: \"p-1 hover:bg-gray-100 rounded\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"h-4 w-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 bg-gray-50 p-2 rounded\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Mode: \", isEnabled ? 'ON' : 'OFF']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Tool: \", tool]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Drawing: \", isDrawing ? 'YES' : 'NO']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Path: \", currentPath.length, \" points\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Overlay: \", overlay ? 'Found' : 'Missing']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: async () => {\n            console.log('üß™ Testing drawing creation...');\n            const testDrawing = {\n              uuid: uuidv4(),\n              pdfUuid,\n              pageNumber,\n              type: 'line',\n              data: {\n                path: [{\n                  x: 0.1,\n                  y: 0.1\n                }, {\n                  x: 0.9,\n                  y: 0.9\n                }],\n                scale\n              },\n              style: {\n                color: '#ff0000',\n                strokeWidth: 2,\n                opacity: 1\n              }\n            };\n            try {\n              await createDrawingMutation.mutateAsync(testDrawing);\n              console.log('‚úÖ Test drawing created');\n            } catch (error) {\n              console.error('‚ùå Test drawing failed:', error);\n            }\n          },\n          className: \"w-full px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200\",\n          children: \"Test API Call\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xs font-medium text-gray-600\",\n            children: \"Tools\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-2\",\n            children: tools.map(toolItem => {\n              const Icon = toolItem.icon;\n              return /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  console.log('üîß Tool changed to:', toolItem.id);\n                  setTool(toolItem.id);\n                },\n                className: `p-2 rounded border flex items-center justify-center ${tool === toolItem.id ? 'bg-blue-100 border-blue-500 text-blue-700' : 'border-gray-300 hover:bg-gray-50'}`,\n                title: toolItem.name,\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 21\n                }, this)\n              }, toolItem.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xs font-medium text-gray-600\",\n            children: \"Color\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-wrap gap-1\",\n            children: colors.map(colorOption => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setColor(colorOption),\n              className: `w-6 h-6 rounded border-2 ${color === colorOption ? 'border-gray-800' : 'border-gray-300'}`,\n              style: {\n                backgroundColor: colorOption\n              }\n            }, colorOption, false, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"color\",\n            value: color,\n            onChange: e => setColor(e.target.value),\n            className: \"w-full h-8 rounded border\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xs font-medium text-gray-600\",\n            children: \"Stroke Width\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"range\",\n            min: \"1\",\n            max: \"10\",\n            value: strokeWidth,\n            onChange: e => setStrokeWidth(parseInt(e.target.value)),\n            className: \"w-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-600\",\n            children: [strokeWidth, \"px\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this), !showTools && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setShowTools(true),\n      className: \"fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-2 z-50\",\n      title: \"Show Drawing Tools\",\n      children: /*#__PURE__*/_jsxDEV(Palette, {\n        className: \"h-5 w-5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 9\n    }, this), isDrawing && overlayRect && /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: svgRef,\n      className: \"fixed pointer-events-none z-40\",\n      style: {\n        left: overlayRect.left,\n        top: overlayRect.top,\n        width: overlayRect.width,\n        height: overlayRect.height\n      },\n      children: renderCurrentDrawing()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(DrawingTools, \"IM9t/ZSandp6qhGTuAPUCMn4Zqk=\", false, function () {\n  return [useQueryClient, useMutation];\n});\n_c = DrawingTools;\nexport default DrawingTools;\nvar _c;\n$RefreshReg$(_c, \"DrawingTools\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","useMutation","useQueryClient","drawingAPI","Pen","ArrowRight","Square","Circle","Minus","Palette","X","v4","uuidv4","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","DrawingTools","pdfUuid","pageNumber","scale","isEnabled","onDrawingChange","pageContainerRef","drawingOverlayRef","_s","tool","setTool","color","setColor","strokeWidth","setStrokeWidth","isDrawing","setIsDrawing","currentPath","setCurrentPath","showTools","setShowTools","svgRef","queryClient","isDrawingRef","startPosRef","createDrawingMutation","create","onMutate","console","log","onSuccess","data","invalidateQueries","success","onError","error","_error$response","_error$response$data","response","message","tools","id","icon","name","colors","getDrawingOverlay","current","getRelativePosition","e","overlay","x","y","rect","getBoundingClientRect","clientX","left","width","clientY","top","height","clampedPos","Math","max","min","client","relative","clamped","handleMouseDown","enabled","preventDefault","stopPropagation","pos","handleMouseMove","prev","newPath","length","handleMouseUp","pathLength","validPath","originalLength","validLength","drawingData","uuid","type","path","style","opacity","mutateAsync","addEventListener","passive","document","removeEventListener","renderCurrentDrawing","pathData","slice","map","p","join","d","stroke","fill","strokeLinecap","strokeLinejoin","fileName","_jsxFileName","lineNumber","columnNumber","x1","y1","x2","y2","last","rectData","abs","lastPos","radius","sqrt","pow","cx","cy","r","start","end","angle","atan2","arrowLength","arrowAngle","PI","children","cos","sin","overlayRect","className","onClick","testDrawing","toolItem","Icon","title","colorOption","backgroundColor","value","onChange","target","parseInt","ref","_c","$RefreshReg$"],"sources":["D:/pdf demo/frontend/src/components/DrawingTools.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { useMutation, useQueryClient } from 'react-query';\r\nimport { drawingAPI } from '../services/api';\r\nimport { Pen, ArrowRight, Square, Circle, Minus, Palette, X } from 'lucide-react';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst DrawingTools = ({ pdfUuid, pageNumber, scale, isEnabled, onDrawingChange, pageContainerRef, drawingOverlayRef }) => {\r\n  const [tool, setTool] = useState('freehand');\r\n  const [color, setColor] = useState('#ff0000');\r\n  const [strokeWidth, setStrokeWidth] = useState(2);\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const [currentPath, setCurrentPath] = useState([]);\r\n  const [showTools, setShowTools] = useState(true);\r\n  \r\n  const svgRef = useRef(null);\r\n  const queryClient = useQueryClient();\r\n  const isDrawingRef = useRef(false);\r\n  const startPosRef = useRef(null);\r\n\r\n  const createDrawingMutation = useMutation(drawingAPI.create, {\r\n    onMutate: () => {\r\n      console.log('üé® Starting drawing mutation...');\r\n    },\r\n    onSuccess: (data) => {\r\n      console.log('‚úÖ Drawing saved successfully:', data);\r\n      queryClient.invalidateQueries(['drawings', pdfUuid]);\r\n      toast.success('Drawing saved!');\r\n    },\r\n    onError: (error) => {\r\n      console.error('‚ùå Failed to save drawing:', error);\r\n      toast.error('Failed to save drawing: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  });\r\n\r\n  const tools = [\r\n    { id: 'freehand', icon: Pen, name: 'Freehand' },\r\n    { id: 'arrow', icon: ArrowRight, name: 'Arrow' },\r\n    { id: 'rectangle', icon: Square, name: 'Rectangle' },\r\n    { id: 'circle', icon: Circle, name: 'Circle' },\r\n    { id: 'line', icon: Minus, name: 'Line' }\r\n  ];\r\n\r\n  const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#000000'];\r\n\r\n  const getDrawingOverlay = useCallback(() => {\r\n    if (!drawingOverlayRef?.current) {\r\n      console.log('‚ùå No drawing overlay ref');\r\n      return null;\r\n    }\r\n    return drawingOverlayRef.current;\r\n  }, [drawingOverlayRef]);\r\n\r\n  const getRelativePosition = useCallback((e) => {\r\n    const overlay = getDrawingOverlay();\r\n    if (!overlay) return { x: 0, y: 0 };\r\n    \r\n    const rect = overlay.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / rect.width;\r\n    const y = (e.clientY - rect.top) / rect.height;\r\n    \r\n    const clampedPos = {\r\n      x: Math.max(0, Math.min(1, x)),\r\n      y: Math.max(0, Math.min(1, y))\r\n    };\r\n    \r\n    console.log('üìç Position:', { \r\n      client: { x: e.clientX, y: e.clientY },\r\n      rect: { left: rect.left, top: rect.top, width: rect.width, height: rect.height },\r\n      relative: { x, y },\r\n      clamped: clampedPos\r\n    });\r\n    \r\n    return clampedPos;\r\n  }, [getDrawingOverlay]);\r\n\r\n  const handleMouseDown = useCallback((e) => {\r\n    if (!isEnabled) {\r\n      console.log('‚ùå Drawing not enabled');\r\n      return;\r\n    }\r\n    \r\n    console.log('üñ±Ô∏è Mouse down - starting drawing', { tool, enabled: isEnabled });\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    isDrawingRef.current = true;\r\n    setIsDrawing(true);\r\n    \r\n    const pos = getRelativePosition(e);\r\n    startPosRef.current = pos;\r\n    setCurrentPath([pos]);\r\n    \r\n    console.log('üé® Started drawing with position:', pos);\r\n  }, [isEnabled, getRelativePosition, tool]);\r\n\r\n  const handleMouseMove = useCallback((e) => {\r\n    if (!isDrawingRef.current || !isEnabled) return;\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const pos = getRelativePosition(e);\r\n    \r\n    if (tool === 'freehand') {\r\n      setCurrentPath(prev => {\r\n        const newPath = [...prev, pos];\r\n        console.log('‚úèÔ∏è Freehand path update, length:', newPath.length);\r\n        return newPath;\r\n      });\r\n    } else {\r\n      // For shapes, only keep start and current position\r\n      setCurrentPath([startPosRef.current, pos]);\r\n    }\r\n  }, [isEnabled, tool, getRelativePosition]);\r\n\r\n  const handleMouseUp = useCallback(async (e) => {\r\n    console.log('üñ±Ô∏è Mouse up triggered', { \r\n      isDrawing: isDrawingRef.current, \r\n      pathLength: currentPath.length,\r\n      tool \r\n    });\r\n    \r\n    if (!isDrawingRef.current || currentPath.length === 0) {\r\n      console.log('‚ùå Not drawing or no path');\r\n      isDrawingRef.current = false;\r\n      setIsDrawing(false);\r\n      setCurrentPath([]);\r\n      return;\r\n    }\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    // Validate path based on tool\r\n    let validPath = [...currentPath];\r\n    if (tool !== 'freehand' && validPath.length > 2) {\r\n      validPath = [validPath[0], validPath[validPath.length - 1]];\r\n    }\r\n    \r\n    console.log('üîç Validating path:', { \r\n      originalLength: currentPath.length, \r\n      validLength: validPath.length,\r\n      tool,\r\n      validPath\r\n    });\r\n    \r\n    if (validPath.length < 2) {\r\n      console.log('‚ùå Path too short, canceling');\r\n      toast.error('Drawing too short - please draw a longer line');\r\n      isDrawingRef.current = false;\r\n      setIsDrawing(false);\r\n      setCurrentPath([]);\r\n      return;\r\n    }\r\n\r\n    const drawingData = {\r\n      uuid: uuidv4(),\r\n      pdfUuid,\r\n      pageNumber,\r\n      type: tool,\r\n      data: {\r\n        path: validPath,\r\n        scale\r\n      },\r\n      style: {\r\n        color,\r\n        strokeWidth,\r\n        opacity: 1\r\n      }\r\n    };\r\n\r\n    console.log('üíæ Attempting to save drawing:', drawingData);\r\n\r\n    try {\r\n      await createDrawingMutation.mutateAsync(drawingData);\r\n      onDrawingChange && onDrawingChange(drawingData);\r\n      console.log('‚úÖ Drawing save initiated successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to save drawing:', error);\r\n    } finally {\r\n      isDrawingRef.current = false;\r\n      setIsDrawing(false);\r\n      setCurrentPath([]);\r\n      startPosRef.current = null;\r\n    }\r\n  }, [currentPath, tool, pdfUuid, pageNumber, scale, color, strokeWidth, createDrawingMutation, onDrawingChange]);\r\n\r\n  // Add event listeners to the drawing overlay\r\n  useEffect(() => {\r\n    if (!isEnabled) {\r\n      console.log('‚ùå Drawing not enabled, skipping event listeners');\r\n      return;\r\n    }\r\n\r\n    const overlay = getDrawingOverlay();\r\n    if (!overlay) {\r\n      console.log('‚ùå No overlay found, cannot add event listeners');\r\n      return;\r\n    }\r\n\r\n    console.log('üéØ Adding event listeners to drawing overlay');\r\n    \r\n    overlay.addEventListener('mousedown', handleMouseDown, { passive: false });\r\n    overlay.addEventListener('mousemove', handleMouseMove, { passive: false });\r\n    overlay.addEventListener('mouseup', handleMouseUp, { passive: false });\r\n    \r\n    // Global mouse up to handle dragging outside overlay\r\n    document.addEventListener('mouseup', handleMouseUp, { passive: false });\r\n\r\n    return () => {\r\n      console.log('üßπ Removing event listeners');\r\n      overlay.removeEventListener('mousedown', handleMouseDown);\r\n      overlay.removeEventListener('mousemove', handleMouseMove);\r\n      overlay.removeEventListener('mouseup', handleMouseUp);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isEnabled, handleMouseDown, handleMouseMove, handleMouseUp, getDrawingOverlay]);\r\n\r\n  const renderCurrentDrawing = () => {\r\n    if (currentPath.length === 0) return null;\r\n\r\n    const overlay = getDrawingOverlay();\r\n    if (!overlay) return null;\r\n\r\n    const rect = overlay.getBoundingClientRect();\r\n\r\n    switch (tool) {\r\n      case 'freehand':\r\n        if (currentPath.length < 2) return null;\r\n        const pathData = `M ${currentPath[0].x * rect.width} ${currentPath[0].y * rect.height} ` +\r\n          currentPath.slice(1).map(p => `L ${p.x * rect.width} ${p.y * rect.height}`).join(' ');\r\n        return (\r\n          <path\r\n            d={pathData}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n            fill=\"none\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n          />\r\n        );\r\n      \r\n      case 'line':\r\n        if (currentPath.length < 2) return null;\r\n        return (\r\n          <line\r\n            x1={currentPath[0].x * rect.width}\r\n            y1={currentPath[0].y * rect.height}\r\n            x2={currentPath[currentPath.length - 1].x * rect.width}\r\n            y2={currentPath[currentPath.length - 1].y * rect.height}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n          />\r\n        );\r\n      \r\n      case 'rectangle':\r\n        if (currentPath.length < 2) return null;\r\n        const last = currentPath[currentPath.length - 1];\r\n        const rectData = {\r\n          x: Math.min(currentPath[0].x, last.x) * rect.width,\r\n          y: Math.min(currentPath[0].y, last.y) * rect.height,\r\n          width: Math.abs(last.x - currentPath[0].x) * rect.width,\r\n          height: Math.abs(last.y - currentPath[0].y) * rect.height\r\n        };\r\n        return (\r\n          <rect\r\n            x={rectData.x}\r\n            y={rectData.y}\r\n            width={rectData.width}\r\n            height={rectData.height}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n            fill=\"none\"\r\n          />\r\n        );\r\n      \r\n      case 'circle':\r\n        if (currentPath.length < 2) return null;\r\n        const lastPos = currentPath[currentPath.length - 1];\r\n        const radius = Math.sqrt(\r\n          Math.pow((lastPos.x - currentPath[0].x) * rect.width, 2) +\r\n          Math.pow((lastPos.y - currentPath[0].y) * rect.height, 2)\r\n        );\r\n        return (\r\n          <circle\r\n            cx={currentPath[0].x * rect.width}\r\n            cy={currentPath[0].y * rect.height}\r\n            r={radius}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n            fill=\"none\"\r\n          />\r\n        );\r\n      \r\n      case 'arrow':\r\n        if (currentPath.length < 2) return null;\r\n        const start = currentPath[0];\r\n        const end = currentPath[currentPath.length - 1];\r\n        const angle = Math.atan2((end.y - start.y) * rect.height, (end.x - start.x) * rect.width);\r\n        const arrowLength = 15;\r\n        const arrowAngle = Math.PI / 6;\r\n        \r\n        return (\r\n          <g>\r\n            <line\r\n              x1={start.x * rect.width}\r\n              y1={start.y * rect.height}\r\n              x2={end.x * rect.width}\r\n              y2={end.y * rect.height}\r\n              stroke={color}\r\n              strokeWidth={strokeWidth}\r\n            />\r\n            <path\r\n              d={`M ${end.x * rect.width} ${end.y * rect.height} \r\n                  L ${end.x * rect.width - arrowLength * Math.cos(angle - arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle - arrowAngle)}\r\n                  M ${end.x * rect.width} ${end.y * rect.height}\r\n                  L ${end.x * rect.width - arrowLength * Math.cos(angle + arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle + arrowAngle)}`}\r\n              stroke={color}\r\n              strokeWidth={strokeWidth}\r\n              fill=\"none\"\r\n            />\r\n          </g>\r\n        );\r\n      \r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  if (!isEnabled) return null;\r\n\r\n  const overlay = getDrawingOverlay();\r\n  const overlayRect = overlay?.getBoundingClientRect();\r\n\r\n  return (\r\n    <>\r\n      {/* Tools Panel */}\r\n      <div className={`fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-4 z-50 transition-transform ${showTools ? '' : '-translate-x-full'}`}>\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <h3 className=\"text-sm font-medium\">Drawing Tools</h3>\r\n            <button\r\n              onClick={() => setShowTools(false)}\r\n              className=\"p-1 hover:bg-gray-100 rounded\"\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Debug Info */}\r\n          <div className=\"text-xs text-gray-500 bg-gray-50 p-2 rounded\">\r\n            <div>Mode: {isEnabled ? 'ON' : 'OFF'}</div>\r\n            <div>Tool: {tool}</div>\r\n            <div>Drawing: {isDrawing ? 'YES' : 'NO'}</div>\r\n            <div>Path: {currentPath.length} points</div>\r\n            <div>Overlay: {overlay ? 'Found' : 'Missing'}</div>\r\n          </div>\r\n\r\n          {/* Test Button */}\r\n          <button\r\n            onClick={async () => {\r\n              console.log('üß™ Testing drawing creation...');\r\n              const testDrawing = {\r\n                uuid: uuidv4(),\r\n                pdfUuid,\r\n                pageNumber,\r\n                type: 'line',\r\n                data: {\r\n                  path: [\r\n                    { x: 0.1, y: 0.1 },\r\n                    { x: 0.9, y: 0.9 }\r\n                  ],\r\n                  scale\r\n                },\r\n                style: {\r\n                  color: '#ff0000',\r\n                  strokeWidth: 2,\r\n                  opacity: 1\r\n                }\r\n              };\r\n              \r\n              try {\r\n                await createDrawingMutation.mutateAsync(testDrawing);\r\n                console.log('‚úÖ Test drawing created');\r\n              } catch (error) {\r\n                console.error('‚ùå Test drawing failed:', error);\r\n              }\r\n            }}\r\n            className=\"w-full px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200\"\r\n          >\r\n            Test API Call\r\n          </button>\r\n\r\n          {/* Tool Selection */}\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"text-xs font-medium text-gray-600\">Tools</h4>\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              {tools.map((toolItem) => {\r\n                const Icon = toolItem.icon;\r\n                return (\r\n                  <button\r\n                    key={toolItem.id}\r\n                    onClick={() => {\r\n                      console.log('üîß Tool changed to:', toolItem.id);\r\n                      setTool(toolItem.id);\r\n                    }}\r\n                    className={`p-2 rounded border flex items-center justify-center ${\r\n                      tool === toolItem.id\r\n                        ? 'bg-blue-100 border-blue-500 text-blue-700'\r\n                        : 'border-gray-300 hover:bg-gray-50'\r\n                    }`}\r\n                    title={toolItem.name}\r\n                  >\r\n                    <Icon className=\"h-4 w-4\" />\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Color Selection */}\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"text-xs font-medium text-gray-600\">Color</h4>\r\n            <div className=\"flex flex-wrap gap-1\">\r\n              {colors.map((colorOption) => (\r\n                <button\r\n                  key={colorOption}\r\n                  onClick={() => setColor(colorOption)}\r\n                  className={`w-6 h-6 rounded border-2 ${\r\n                    color === colorOption ? 'border-gray-800' : 'border-gray-300'\r\n                  }`}\r\n                  style={{ backgroundColor: colorOption }}\r\n                />\r\n              ))}\r\n            </div>\r\n            <input\r\n              type=\"color\"\r\n              value={color}\r\n              onChange={(e) => setColor(e.target.value)}\r\n              className=\"w-full h-8 rounded border\"\r\n            />\r\n          </div>\r\n\r\n          {/* Stroke Width */}\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"text-xs font-medium text-gray-600\">Stroke Width</h4>\r\n            <input\r\n              type=\"range\"\r\n              min=\"1\"\r\n              max=\"10\"\r\n              value={strokeWidth}\r\n              onChange={(e) => setStrokeWidth(parseInt(e.target.value))}\r\n              className=\"w-full\"\r\n            />\r\n            <div className=\"text-xs text-gray-600\">{strokeWidth}px</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Show Tools Button (when hidden) */}\r\n      {!showTools && (\r\n        <button\r\n          onClick={() => setShowTools(true)}\r\n          className=\"fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-2 z-50\"\r\n          title=\"Show Drawing Tools\"\r\n        >\r\n          <Palette className=\"h-5 w-5\" />\r\n        </button>\r\n      )}\r\n\r\n      {/* Drawing Preview Overlay */}\r\n      {isDrawing && overlayRect && (\r\n        <svg\r\n          ref={svgRef}\r\n          className=\"fixed pointer-events-none z-40\"\r\n          style={{ \r\n            left: overlayRect.left,\r\n            top: overlayRect.top,\r\n            width: overlayRect.width,\r\n            height: overlayRect.height\r\n          }}\r\n        >\r\n          {renderCurrentDrawing()}\r\n        </svg>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DrawingTools;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}