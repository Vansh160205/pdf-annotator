{"ast":null,"code":"var _jsxFileName = \"D:\\\\pdf demo\\\\frontend\\\\src\\\\components\\\\DrawingTools.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { useMutation, useQueryClient } from 'react-query';\nimport { drawingAPI } from '../services/api';\nimport { Pen, ArrowRight, Square, Circle, Minus, Palette, X } from 'lucide-react';\nimport { v4 as uuidv4 } from 'uuid';\nimport toast from 'react-hot-toast';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DrawingTools = ({\n  pdfUuid,\n  pageNumber,\n  scale,\n  isEnabled,\n  onDrawingChange,\n  pageContainerRef\n}) => {\n  _s();\n  const [tool, setTool] = useState('freehand');\n  const [color, setColor] = useState('#ff0000');\n  const [strokeWidth, setStrokeWidth] = useState(2);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [currentPath, setCurrentPath] = useState([]);\n  const [showTools, setShowTools] = useState(true);\n  const svgRef = useRef(null);\n  const queryClient = useQueryClient();\n  const isDrawingRef = useRef(false);\n  const createDrawingMutation = useMutation(drawingAPI.create, {\n    onMutate: () => {\n      console.log('üé® Starting drawing mutation...');\n    },\n    onSuccess: data => {\n      console.log('‚úÖ Drawing saved successfully:', data);\n      queryClient.invalidateQueries(['drawings', pdfUuid]);\n      toast.success('Drawing saved!');\n    },\n    onError: error => {\n      var _error$response, _error$response$data;\n      console.error('‚ùå Failed to save drawing:', error);\n      toast.error('Failed to save drawing: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message));\n    }\n  });\n  const tools = [{\n    id: 'freehand',\n    icon: Pen,\n    name: 'Freehand'\n  }, {\n    id: 'arrow',\n    icon: ArrowRight,\n    name: 'Arrow'\n  }, {\n    id: 'rectangle',\n    icon: Square,\n    name: 'Rectangle'\n  }, {\n    id: 'circle',\n    icon: Circle,\n    name: 'Circle'\n  }, {\n    id: 'line',\n    icon: Minus,\n    name: 'Line'\n  }];\n  const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#000000'];\n  const getPageCanvas = useCallback(() => {\n    if (!(pageContainerRef !== null && pageContainerRef !== void 0 && pageContainerRef.current)) {\n      console.log('‚ùå No page container ref');\n      return null;\n    }\n    const pageContainer = pageContainerRef.current;\n    const canvas = pageContainer.querySelector('canvas');\n    if (!canvas) {\n      console.log('‚ùå No canvas found in page container');\n    }\n    return canvas;\n  }, [pageContainerRef]);\n  const getRelativePosition = useCallback(e => {\n    const canvas = getPageCanvas();\n    if (!canvas) return {\n      x: 0,\n      y: 0\n    };\n    const rect = canvas.getBoundingClientRect();\n    const x = (e.clientX - rect.left) / rect.width;\n    const y = (e.clientY - rect.top) / rect.height;\n\n    // Clamp to valid range\n    const clampedPos = {\n      x: Math.max(0, Math.min(1, x)),\n      y: Math.max(0, Math.min(1, y))\n    };\n    console.log('üìç Position:', {\n      client: {\n        x: e.clientX,\n        y: e.clientY\n      },\n      rect: {\n        left: rect.left,\n        top: rect.top,\n        width: rect.width,\n        height: rect.height\n      },\n      relative: {\n        x,\n        y\n      },\n      clamped: clampedPos\n    });\n    return clampedPos;\n  }, [getPageCanvas]);\n  const handleMouseDown = useCallback(e => {\n    if (!isEnabled) {\n      console.log('‚ùå Drawing not enabled');\n      return;\n    }\n    console.log('üñ±Ô∏è Mouse down - starting drawing', {\n      tool,\n      enabled: isEnabled\n    });\n    e.preventDefault();\n    e.stopPropagation();\n    isDrawingRef.current = true;\n    setIsDrawing(true);\n    const pos = getRelativePosition(e);\n    setCurrentPath([pos]);\n    console.log('üé® Started drawing with position:', pos);\n  }, [isEnabled, getRelativePosition, tool]);\n  const handleMouseMove = useCallback(e => {\n    if (!isDrawingRef.current || !isEnabled) return;\n    e.preventDefault();\n    e.stopPropagation();\n    const pos = getRelativePosition(e);\n    if (tool === 'freehand') {\n      setCurrentPath(prev => {\n        const newPath = [...prev, pos];\n        console.log('‚úèÔ∏è Freehand path update, length:', newPath.length);\n        return newPath;\n      });\n    } else {\n      // For shapes, only keep start and current position\n      setCurrentPath(prev => {\n        const newPath = [prev[0], pos];\n        console.log('üìê Shape path update:', newPath);\n        return newPath;\n      });\n    }\n  }, [isEnabled, tool, getRelativePosition]);\n  const handleMouseUp = useCallback(async e => {\n    console.log('üñ±Ô∏è Mouse up triggered', {\n      isDrawing: isDrawingRef.current,\n      pathLength: currentPath.length,\n      tool\n    });\n    if (!isDrawingRef.current || currentPath.length === 0) {\n      console.log('‚ùå Not drawing or no path');\n      isDrawingRef.current = false;\n      setIsDrawing(false);\n      setCurrentPath([]);\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n\n    // Validate path based on tool\n    let validPath = [...currentPath];\n    if (tool !== 'freehand' && validPath.length > 2) {\n      validPath = [validPath[0], validPath[validPath.length - 1]];\n    }\n    console.log('üîç Validating path:', {\n      originalLength: currentPath.length,\n      validLength: validPath.length,\n      tool,\n      validPath\n    });\n    if (validPath.length < 2) {\n      console.log('‚ùå Path too short, canceling');\n      toast.error('Drawing too short - please draw a longer line');\n      isDrawingRef.current = false;\n      setIsDrawing(false);\n      setCurrentPath([]);\n      return;\n    }\n    const drawingData = {\n      uuid: uuidv4(),\n      pdfUuid,\n      pageNumber,\n      type: tool,\n      data: {\n        path: validPath,\n        scale\n      },\n      style: {\n        color,\n        strokeWidth,\n        opacity: 1\n      }\n    };\n    console.log('üíæ Attempting to save drawing:', drawingData);\n    try {\n      await createDrawingMutation.mutateAsync(drawingData);\n      onDrawingChange && onDrawingChange(drawingData);\n      console.log('‚úÖ Drawing save initiated successfully');\n    } catch (error) {\n      console.error('‚ùå Failed to save drawing:', error);\n    } finally {\n      isDrawingRef.current = false;\n      setIsDrawing(false);\n      setCurrentPath([]);\n    }\n  }, [currentPath, tool, pdfUuid, pageNumber, scale, color, strokeWidth, createDrawingMutation, onDrawingChange]);\n\n  // Global mouse up handler to catch mouse up outside canvas\n  const handleGlobalMouseUp = useCallback(e => {\n    if (isDrawingRef.current) {\n      console.log('üåç Global mouse up caught');\n      handleMouseUp(e);\n    }\n  }, [handleMouseUp]);\n\n  // Add event listeners\n  useEffect(() => {\n    if (!isEnabled) {\n      console.log('‚ùå Drawing not enabled, skipping event listeners');\n      return;\n    }\n    const canvas = getPageCanvas();\n    if (!canvas) {\n      console.log('‚ùå No canvas found, cannot add event listeners');\n      return;\n    }\n    console.log('üéØ Adding event listeners to canvas');\n\n    // Prevent text selection while drawing\n    const preventSelection = e => {\n      if (isDrawingRef.current) {\n        e.preventDefault();\n      }\n    };\n    canvas.addEventListener('mousedown', handleMouseDown, {\n      passive: false\n    });\n    canvas.addEventListener('mousemove', handleMouseMove, {\n      passive: false\n    });\n    canvas.addEventListener('mouseup', handleMouseUp, {\n      passive: false\n    });\n    canvas.addEventListener('selectstart', preventSelection);\n\n    // Global mouse up to handle dragging outside canvas\n    document.addEventListener('mouseup', handleGlobalMouseUp, {\n      passive: false\n    });\n\n    // Set cursor\n    canvas.style.cursor = 'crosshair';\n\n    // Disable user selection on canvas while drawing\n    canvas.style.userSelect = 'none';\n    canvas.style.webkitUserSelect = 'none';\n    return () => {\n      console.log('üßπ Removing event listeners');\n      canvas.removeEventListener('mousedown', handleMouseDown);\n      canvas.removeEventListener('mousemove', handleMouseMove);\n      canvas.removeEventListener('mouseup', handleMouseUp);\n      canvas.removeEventListener('selectstart', preventSelection);\n      document.removeEventListener('mouseup', handleGlobalMouseUp);\n      canvas.style.cursor = 'default';\n      canvas.style.userSelect = '';\n      canvas.style.webkitUserSelect = '';\n    };\n  }, [isEnabled, handleMouseDown, handleMouseMove, handleMouseUp, handleGlobalMouseUp, getPageCanvas]);\n\n  // Debug: Log when isEnabled changes\n  useEffect(() => {\n    console.log('üîÑ Drawing mode changed:', {\n      isEnabled,\n      tool\n    });\n  }, [isEnabled, tool]);\n  const renderCurrentDrawing = () => {\n    if (currentPath.length === 0) return null;\n    const canvas = getPageCanvas();\n    if (!canvas) return null;\n    const rect = canvas.getBoundingClientRect();\n    switch (tool) {\n      case 'freehand':\n        if (currentPath.length < 2) return null;\n        const pathData = `M ${currentPath[0].x * rect.width} ${currentPath[0].y * rect.height} ` + currentPath.slice(1).map(p => `L ${p.x * rect.width} ${p.y * rect.height}`).join(' ');\n        return /*#__PURE__*/_jsxDEV(\"path\", {\n          d: pathData,\n          stroke: color,\n          strokeWidth: strokeWidth,\n          fill: \"none\",\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 11\n        }, this);\n      case 'line':\n        if (currentPath.length < 2) return null;\n        return /*#__PURE__*/_jsxDEV(\"line\", {\n          x1: currentPath[0].x * rect.width,\n          y1: currentPath[0].y * rect.height,\n          x2: currentPath[1].x * rect.width,\n          y2: currentPath[1].y * rect.height,\n          stroke: color,\n          strokeWidth: strokeWidth\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this);\n      case 'rectangle':\n        if (currentPath.length < 2) return null;\n        const rectData = {\n          x: Math.min(currentPath[0].x, currentPath[1].x) * rect.width,\n          y: Math.min(currentPath[0].y, currentPath[1].y) * rect.height,\n          width: Math.abs(currentPath[1].x - currentPath[0].x) * rect.width,\n          height: Math.abs(currentPath[1].y - currentPath[0].y) * rect.height\n        };\n        return /*#__PURE__*/_jsxDEV(\"rect\", {\n          x: rectData.x,\n          y: rectData.y,\n          width: rectData.width,\n          height: rectData.height,\n          stroke: color,\n          strokeWidth: strokeWidth,\n          fill: \"none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 11\n        }, this);\n      case 'circle':\n        if (currentPath.length < 2) return null;\n        const radius = Math.sqrt(Math.pow((currentPath[1].x - currentPath[0].x) * rect.width, 2) + Math.pow((currentPath[1].y - currentPath[0].y) * rect.height, 2));\n        return /*#__PURE__*/_jsxDEV(\"circle\", {\n          cx: currentPath[0].x * rect.width,\n          cy: currentPath[0].y * rect.height,\n          r: radius,\n          stroke: color,\n          strokeWidth: strokeWidth,\n          fill: \"none\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 11\n        }, this);\n      case 'arrow':\n        if (currentPath.length < 2) return null;\n        const start = currentPath[0];\n        const end = currentPath[1];\n        const angle = Math.atan2((end.y - start.y) * rect.height, (end.x - start.x) * rect.width);\n        const arrowLength = 15;\n        const arrowAngle = Math.PI / 6;\n        return /*#__PURE__*/_jsxDEV(\"g\", {\n          children: [/*#__PURE__*/_jsxDEV(\"line\", {\n            x1: start.x * rect.width,\n            y1: start.y * rect.height,\n            x2: end.x * rect.width,\n            y2: end.y * rect.height,\n            stroke: color,\n            strokeWidth: strokeWidth\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 345,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            d: `M ${end.x * rect.width} ${end.y * rect.height} \n                  L ${end.x * rect.width - arrowLength * Math.cos(angle - arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle - arrowAngle)}\n                  M ${end.x * rect.width} ${end.y * rect.height}\n                  L ${end.x * rect.width - arrowLength * Math.cos(angle + arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle + arrowAngle)}`,\n            stroke: color,\n            strokeWidth: strokeWidth,\n            fill: \"none\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n  if (!isEnabled) return null;\n  const canvas = getPageCanvas();\n  const canvasRect = canvas === null || canvas === void 0 ? void 0 : canvas.getBoundingClientRect();\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-4 z-40 transition-transform ${showTools ? '' : '-translate-x-full'}`,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-sm font-medium\",\n            children: \"Drawing Tools\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowTools(false),\n            className: \"p-1 hover:bg-gray-100 rounded\",\n            children: /*#__PURE__*/_jsxDEV(X, {\n              className: \"h-4 w-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-500 bg-gray-50 p-2 rounded\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Mode: \", isEnabled ? 'ON' : 'OFF']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Tool: \", tool]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Drawing: \", isDrawing ? 'YES' : 'NO']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Path: \", currentPath.length, \" points\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Canvas: \", canvas ? 'Found' : 'Missing']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 397,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: async () => {\n            console.log('üß™ Testing drawing creation...');\n            const testDrawing = {\n              uuid: uuidv4(),\n              pdfUuid,\n              pageNumber,\n              type: 'line',\n              data: {\n                path: [{\n                  x: 0.1,\n                  y: 0.1\n                }, {\n                  x: 0.9,\n                  y: 0.9\n                }],\n                scale\n              },\n              style: {\n                color: '#ff0000',\n                strokeWidth: 2,\n                opacity: 1\n              }\n            };\n            try {\n              await createDrawingMutation.mutateAsync(testDrawing);\n              console.log('‚úÖ Test drawing created');\n            } catch (error) {\n              console.error('‚ùå Test drawing failed:', error);\n            }\n          },\n          className: \"w-full px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200\",\n          children: \"Test API Call\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xs font-medium text-gray-600\",\n            children: \"Tools\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-2\",\n            children: tools.map(toolItem => {\n              const Icon = toolItem.icon;\n              return /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  console.log('üîß Tool changed to:', toolItem.id);\n                  setTool(toolItem.id);\n                },\n                className: `p-2 rounded border flex items-center justify-center ${tool === toolItem.id ? 'bg-blue-100 border-blue-500 text-blue-700' : 'border-gray-300 hover:bg-gray-50'}`,\n                title: toolItem.name,\n                children: /*#__PURE__*/_jsxDEV(Icon, {\n                  className: \"h-4 w-4\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 455,\n                  columnNumber: 21\n                }, this)\n              }, toolItem.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 442,\n                columnNumber: 19\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 436,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xs font-medium text-gray-600\",\n            children: \"Color\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 464,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex flex-wrap gap-1\",\n            children: colors.map(colorOption => /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setColor(colorOption),\n              className: `w-6 h-6 rounded border-2 ${color === colorOption ? 'border-gray-800' : 'border-gray-300'}`,\n              style: {\n                backgroundColor: colorOption\n              }\n            }, colorOption, false, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"color\",\n            value: color,\n            onChange: e => setColor(e.target.value),\n            className: \"w-full h-8 rounded border\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"text-xs font-medium text-gray-600\",\n            children: \"Stroke Width\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"range\",\n            min: \"1\",\n            max: \"10\",\n            value: strokeWidth,\n            onChange: e => setStrokeWidth(parseInt(e.target.value)),\n            className: \"w-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-600\",\n            children: [strokeWidth, \"px\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 379,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 7\n    }, this), !showTools && /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setShowTools(true),\n      className: \"fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-2 z-40\",\n      title: \"Show Drawing Tools\",\n      children: /*#__PURE__*/_jsxDEV(Palette, {\n        className: \"h-5 w-5\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 508,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 9\n    }, this), isDrawing && canvasRect && /*#__PURE__*/_jsxDEV(\"svg\", {\n      ref: svgRef,\n      className: \"fixed pointer-events-none z-30\",\n      style: {\n        left: canvasRect.left,\n        top: canvasRect.top,\n        width: canvasRect.width,\n        height: canvasRect.height\n      },\n      children: renderCurrentDrawing()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true);\n};\n_s(DrawingTools, \"jPClaSBgoMlUiyvPruRd6yMTxog=\", false, function () {\n  return [useQueryClient, useMutation];\n});\n_c = DrawingTools;\nexport default DrawingTools;\nvar _c;\n$RefreshReg$(_c, \"DrawingTools\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","useMutation","useQueryClient","drawingAPI","Pen","ArrowRight","Square","Circle","Minus","Palette","X","v4","uuidv4","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","DrawingTools","pdfUuid","pageNumber","scale","isEnabled","onDrawingChange","pageContainerRef","_s","tool","setTool","color","setColor","strokeWidth","setStrokeWidth","isDrawing","setIsDrawing","currentPath","setCurrentPath","showTools","setShowTools","svgRef","queryClient","isDrawingRef","createDrawingMutation","create","onMutate","console","log","onSuccess","data","invalidateQueries","success","onError","error","_error$response","_error$response$data","response","message","tools","id","icon","name","colors","getPageCanvas","current","pageContainer","canvas","querySelector","getRelativePosition","e","x","y","rect","getBoundingClientRect","clientX","left","width","clientY","top","height","clampedPos","Math","max","min","client","relative","clamped","handleMouseDown","enabled","preventDefault","stopPropagation","pos","handleMouseMove","prev","newPath","length","handleMouseUp","pathLength","validPath","originalLength","validLength","drawingData","uuid","type","path","style","opacity","mutateAsync","handleGlobalMouseUp","preventSelection","addEventListener","passive","document","cursor","userSelect","webkitUserSelect","removeEventListener","renderCurrentDrawing","pathData","slice","map","p","join","d","stroke","fill","strokeLinecap","strokeLinejoin","fileName","_jsxFileName","lineNumber","columnNumber","x1","y1","x2","y2","rectData","abs","radius","sqrt","pow","cx","cy","r","start","end","angle","atan2","arrowLength","arrowAngle","PI","children","cos","sin","canvasRect","className","onClick","testDrawing","toolItem","Icon","title","colorOption","backgroundColor","value","onChange","target","parseInt","ref","_c","$RefreshReg$"],"sources":["D:/pdf demo/frontend/src/components/DrawingTools.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { useMutation, useQueryClient } from 'react-query';\r\nimport { drawingAPI } from '../services/api';\r\nimport { Pen, ArrowRight, Square, Circle, Minus, Palette, X } from 'lucide-react';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst DrawingTools = ({ pdfUuid, pageNumber, scale, isEnabled, onDrawingChange, pageContainerRef }) => {\r\n  const [tool, setTool] = useState('freehand');\r\n  const [color, setColor] = useState('#ff0000');\r\n  const [strokeWidth, setStrokeWidth] = useState(2);\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const [currentPath, setCurrentPath] = useState([]);\r\n  const [showTools, setShowTools] = useState(true);\r\n  \r\n  const svgRef = useRef(null);\r\n  const queryClient = useQueryClient();\r\n  const isDrawingRef = useRef(false);\r\n\r\n  const createDrawingMutation = useMutation(drawingAPI.create, {\r\n    onMutate: () => {\r\n      console.log('üé® Starting drawing mutation...');\r\n    },\r\n    onSuccess: (data) => {\r\n      console.log('‚úÖ Drawing saved successfully:', data);\r\n      queryClient.invalidateQueries(['drawings', pdfUuid]);\r\n      toast.success('Drawing saved!');\r\n    },\r\n    onError: (error) => {\r\n      console.error('‚ùå Failed to save drawing:', error);\r\n      toast.error('Failed to save drawing: ' + (error.response?.data?.message || error.message));\r\n    }\r\n  });\r\n\r\n  const tools = [\r\n    { id: 'freehand', icon: Pen, name: 'Freehand' },\r\n    { id: 'arrow', icon: ArrowRight, name: 'Arrow' },\r\n    { id: 'rectangle', icon: Square, name: 'Rectangle' },\r\n    { id: 'circle', icon: Circle, name: 'Circle' },\r\n    { id: 'line', icon: Minus, name: 'Line' }\r\n  ];\r\n\r\n  const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#000000'];\r\n\r\n  const getPageCanvas = useCallback(() => {\r\n    if (!pageContainerRef?.current) {\r\n      console.log('‚ùå No page container ref');\r\n      return null;\r\n    }\r\n    const pageContainer = pageContainerRef.current;\r\n    const canvas = pageContainer.querySelector('canvas');\r\n    if (!canvas) {\r\n      console.log('‚ùå No canvas found in page container');\r\n    }\r\n    return canvas;\r\n  }, [pageContainerRef]);\r\n\r\n  const getRelativePosition = useCallback((e) => {\r\n    const canvas = getPageCanvas();\r\n    if (!canvas) return { x: 0, y: 0 };\r\n    \r\n    const rect = canvas.getBoundingClientRect();\r\n    const x = (e.clientX - rect.left) / rect.width;\r\n    const y = (e.clientY - rect.top) / rect.height;\r\n    \r\n    // Clamp to valid range\r\n    const clampedPos = {\r\n      x: Math.max(0, Math.min(1, x)),\r\n      y: Math.max(0, Math.min(1, y))\r\n    };\r\n    \r\n    console.log('üìç Position:', { \r\n      client: { x: e.clientX, y: e.clientY },\r\n      rect: { left: rect.left, top: rect.top, width: rect.width, height: rect.height },\r\n      relative: { x, y },\r\n      clamped: clampedPos\r\n    });\r\n    \r\n    return clampedPos;\r\n  }, [getPageCanvas]);\r\n\r\n  const handleMouseDown = useCallback((e) => {\r\n    if (!isEnabled) {\r\n      console.log('‚ùå Drawing not enabled');\r\n      return;\r\n    }\r\n    \r\n    console.log('üñ±Ô∏è Mouse down - starting drawing', { tool, enabled: isEnabled });\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    isDrawingRef.current = true;\r\n    setIsDrawing(true);\r\n    \r\n    const pos = getRelativePosition(e);\r\n    setCurrentPath([pos]);\r\n    \r\n    console.log('üé® Started drawing with position:', pos);\r\n  }, [isEnabled, getRelativePosition, tool]);\r\n\r\n  const handleMouseMove = useCallback((e) => {\r\n    if (!isDrawingRef.current || !isEnabled) return;\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const pos = getRelativePosition(e);\r\n    \r\n    if (tool === 'freehand') {\r\n      setCurrentPath(prev => {\r\n        const newPath = [...prev, pos];\r\n        console.log('‚úèÔ∏è Freehand path update, length:', newPath.length);\r\n        return newPath;\r\n      });\r\n    } else {\r\n      // For shapes, only keep start and current position\r\n      setCurrentPath(prev => {\r\n        const newPath = [prev[0], pos];\r\n        console.log('üìê Shape path update:', newPath);\r\n        return newPath;\r\n      });\r\n    }\r\n  }, [isEnabled, tool, getRelativePosition]);\r\n\r\n  const handleMouseUp = useCallback(async (e) => {\r\n    console.log('üñ±Ô∏è Mouse up triggered', { \r\n      isDrawing: isDrawingRef.current, \r\n      pathLength: currentPath.length,\r\n      tool \r\n    });\r\n    \r\n    if (!isDrawingRef.current || currentPath.length === 0) {\r\n      console.log('‚ùå Not drawing or no path');\r\n      isDrawingRef.current = false;\r\n      setIsDrawing(false);\r\n      setCurrentPath([]);\r\n      return;\r\n    }\r\n    \r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    // Validate path based on tool\r\n    let validPath = [...currentPath];\r\n    if (tool !== 'freehand' && validPath.length > 2) {\r\n      validPath = [validPath[0], validPath[validPath.length - 1]];\r\n    }\r\n    \r\n    console.log('üîç Validating path:', { \r\n      originalLength: currentPath.length, \r\n      validLength: validPath.length,\r\n      tool,\r\n      validPath\r\n    });\r\n    \r\n    if (validPath.length < 2) {\r\n      console.log('‚ùå Path too short, canceling');\r\n      toast.error('Drawing too short - please draw a longer line');\r\n      isDrawingRef.current = false;\r\n      setIsDrawing(false);\r\n      setCurrentPath([]);\r\n      return;\r\n    }\r\n\r\n    const drawingData = {\r\n      uuid: uuidv4(),\r\n      pdfUuid,\r\n      pageNumber,\r\n      type: tool,\r\n      data: {\r\n        path: validPath,\r\n        scale\r\n      },\r\n      style: {\r\n        color,\r\n        strokeWidth,\r\n        opacity: 1\r\n      }\r\n    };\r\n\r\n    console.log('üíæ Attempting to save drawing:', drawingData);\r\n\r\n    try {\r\n      await createDrawingMutation.mutateAsync(drawingData);\r\n      onDrawingChange && onDrawingChange(drawingData);\r\n      console.log('‚úÖ Drawing save initiated successfully');\r\n    } catch (error) {\r\n      console.error('‚ùå Failed to save drawing:', error);\r\n    } finally {\r\n      isDrawingRef.current = false;\r\n      setIsDrawing(false);\r\n      setCurrentPath([]);\r\n    }\r\n  }, [currentPath, tool, pdfUuid, pageNumber, scale, color, strokeWidth, createDrawingMutation, onDrawingChange]);\r\n\r\n  // Global mouse up handler to catch mouse up outside canvas\r\n  const handleGlobalMouseUp = useCallback((e) => {\r\n    if (isDrawingRef.current) {\r\n      console.log('üåç Global mouse up caught');\r\n      handleMouseUp(e);\r\n    }\r\n  }, [handleMouseUp]);\r\n\r\n  // Add event listeners\r\n  useEffect(() => {\r\n    if (!isEnabled) {\r\n      console.log('‚ùå Drawing not enabled, skipping event listeners');\r\n      return;\r\n    }\r\n\r\n    const canvas = getPageCanvas();\r\n    if (!canvas) {\r\n      console.log('‚ùå No canvas found, cannot add event listeners');\r\n      return;\r\n    }\r\n\r\n    console.log('üéØ Adding event listeners to canvas');\r\n    \r\n    // Prevent text selection while drawing\r\n    const preventSelection = (e) => {\r\n      if (isDrawingRef.current) {\r\n        e.preventDefault();\r\n      }\r\n    };\r\n    \r\n    canvas.addEventListener('mousedown', handleMouseDown, { passive: false });\r\n    canvas.addEventListener('mousemove', handleMouseMove, { passive: false });\r\n    canvas.addEventListener('mouseup', handleMouseUp, { passive: false });\r\n    canvas.addEventListener('selectstart', preventSelection);\r\n    \r\n    // Global mouse up to handle dragging outside canvas\r\n    document.addEventListener('mouseup', handleGlobalMouseUp, { passive: false });\r\n    \r\n    // Set cursor\r\n    canvas.style.cursor = 'crosshair';\r\n    \r\n    // Disable user selection on canvas while drawing\r\n    canvas.style.userSelect = 'none';\r\n    canvas.style.webkitUserSelect = 'none';\r\n\r\n    return () => {\r\n      console.log('üßπ Removing event listeners');\r\n      canvas.removeEventListener('mousedown', handleMouseDown);\r\n      canvas.removeEventListener('mousemove', handleMouseMove);\r\n      canvas.removeEventListener('mouseup', handleMouseUp);\r\n      canvas.removeEventListener('selectstart', preventSelection);\r\n      document.removeEventListener('mouseup', handleGlobalMouseUp);\r\n      \r\n      canvas.style.cursor = 'default';\r\n      canvas.style.userSelect = '';\r\n      canvas.style.webkitUserSelect = '';\r\n    };\r\n  }, [isEnabled, handleMouseDown, handleMouseMove, handleMouseUp, handleGlobalMouseUp, getPageCanvas]);\r\n\r\n  // Debug: Log when isEnabled changes\r\n  useEffect(() => {\r\n    console.log('üîÑ Drawing mode changed:', { isEnabled, tool });\r\n  }, [isEnabled, tool]);\r\n\r\n  const renderCurrentDrawing = () => {\r\n    if (currentPath.length === 0) return null;\r\n\r\n    const canvas = getPageCanvas();\r\n    if (!canvas) return null;\r\n\r\n    const rect = canvas.getBoundingClientRect();\r\n\r\n    switch (tool) {\r\n      case 'freehand':\r\n        if (currentPath.length < 2) return null;\r\n        const pathData = `M ${currentPath[0].x * rect.width} ${currentPath[0].y * rect.height} ` +\r\n          currentPath.slice(1).map(p => `L ${p.x * rect.width} ${p.y * rect.height}`).join(' ');\r\n        return (\r\n          <path\r\n            d={pathData}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n            fill=\"none\"\r\n            strokeLinecap=\"round\"\r\n            strokeLinejoin=\"round\"\r\n          />\r\n        );\r\n      \r\n      case 'line':\r\n        if (currentPath.length < 2) return null;\r\n        return (\r\n          <line\r\n            x1={currentPath[0].x * rect.width}\r\n            y1={currentPath[0].y * rect.height}\r\n            x2={currentPath[1].x * rect.width}\r\n            y2={currentPath[1].y * rect.height}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n          />\r\n        );\r\n      \r\n      case 'rectangle':\r\n        if (currentPath.length < 2) return null;\r\n        const rectData = {\r\n          x: Math.min(currentPath[0].x, currentPath[1].x) * rect.width,\r\n          y: Math.min(currentPath[0].y, currentPath[1].y) * rect.height,\r\n          width: Math.abs(currentPath[1].x - currentPath[0].x) * rect.width,\r\n          height: Math.abs(currentPath[1].y - currentPath[0].y) * rect.height\r\n        };\r\n        return (\r\n          <rect\r\n            x={rectData.x}\r\n            y={rectData.y}\r\n            width={rectData.width}\r\n            height={rectData.height}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n            fill=\"none\"\r\n          />\r\n        );\r\n      \r\n      case 'circle':\r\n        if (currentPath.length < 2) return null;\r\n        const radius = Math.sqrt(\r\n          Math.pow((currentPath[1].x - currentPath[0].x) * rect.width, 2) +\r\n          Math.pow((currentPath[1].y - currentPath[0].y) * rect.height, 2)\r\n        );\r\n        return (\r\n          <circle\r\n            cx={currentPath[0].x * rect.width}\r\n            cy={currentPath[0].y * rect.height}\r\n            r={radius}\r\n            stroke={color}\r\n            strokeWidth={strokeWidth}\r\n            fill=\"none\"\r\n          />\r\n        );\r\n      \r\n      case 'arrow':\r\n        if (currentPath.length < 2) return null;\r\n        const start = currentPath[0];\r\n        const end = currentPath[1];\r\n        const angle = Math.atan2((end.y - start.y) * rect.height, (end.x - start.x) * rect.width);\r\n        const arrowLength = 15;\r\n        const arrowAngle = Math.PI / 6;\r\n        \r\n        return (\r\n          <g>\r\n            <line\r\n              x1={start.x * rect.width}\r\n              y1={start.y * rect.height}\r\n              x2={end.x * rect.width}\r\n              y2={end.y * rect.height}\r\n              stroke={color}\r\n              strokeWidth={strokeWidth}\r\n            />\r\n            <path\r\n              d={`M ${end.x * rect.width} ${end.y * rect.height} \r\n                  L ${end.x * rect.width - arrowLength * Math.cos(angle - arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle - arrowAngle)}\r\n                  M ${end.x * rect.width} ${end.y * rect.height}\r\n                  L ${end.x * rect.width - arrowLength * Math.cos(angle + arrowAngle)} ${end.y * rect.height - arrowLength * Math.sin(angle + arrowAngle)}`}\r\n              stroke={color}\r\n              strokeWidth={strokeWidth}\r\n              fill=\"none\"\r\n            />\r\n          </g>\r\n        );\r\n      \r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  if (!isEnabled) return null;\r\n\r\n  const canvas = getPageCanvas();\r\n  const canvasRect = canvas?.getBoundingClientRect();\r\n\r\n  return (\r\n    <>\r\n      {/* Tools Panel */}\r\n      <div className={`fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-4 z-40 transition-transform ${showTools ? '' : '-translate-x-full'}`}>\r\n        <div className=\"space-y-4\">\r\n          {/* Toggle Button */}\r\n          <div className=\"flex justify-between items-center\">\r\n            <h3 className=\"text-sm font-medium\">Drawing Tools</h3>\r\n            <button\r\n              onClick={() => setShowTools(false)}\r\n              className=\"p-1 hover:bg-gray-100 rounded\"\r\n            >\r\n              <X className=\"h-4 w-4\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Debug Info */}\r\n          <div className=\"text-xs text-gray-500 bg-gray-50 p-2 rounded\">\r\n            <div>Mode: {isEnabled ? 'ON' : 'OFF'}</div>\r\n            <div>Tool: {tool}</div>\r\n            <div>Drawing: {isDrawing ? 'YES' : 'NO'}</div>\r\n            <div>Path: {currentPath.length} points</div>\r\n            <div>Canvas: {canvas ? 'Found' : 'Missing'}</div>\r\n          </div>\r\n\r\n          {/* Test Button */}\r\n          <button\r\n            onClick={async () => {\r\n              console.log('üß™ Testing drawing creation...');\r\n              const testDrawing = {\r\n                uuid: uuidv4(),\r\n                pdfUuid,\r\n                pageNumber,\r\n                type: 'line',\r\n                data: {\r\n                  path: [\r\n                    { x: 0.1, y: 0.1 },\r\n                    { x: 0.9, y: 0.9 }\r\n                  ],\r\n                  scale\r\n                },\r\n                style: {\r\n                  color: '#ff0000',\r\n                  strokeWidth: 2,\r\n                  opacity: 1\r\n                }\r\n              };\r\n              \r\n              try {\r\n                await createDrawingMutation.mutateAsync(testDrawing);\r\n                console.log('‚úÖ Test drawing created');\r\n              } catch (error) {\r\n                console.error('‚ùå Test drawing failed:', error);\r\n              }\r\n            }}\r\n            className=\"w-full px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded hover:bg-blue-200\"\r\n          >\r\n            Test API Call\r\n          </button>\r\n\r\n          {/* Tool Selection */}\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"text-xs font-medium text-gray-600\">Tools</h4>\r\n            <div className=\"grid grid-cols-2 gap-2\">\r\n              {tools.map((toolItem) => {\r\n                const Icon = toolItem.icon;\r\n                return (\r\n                  <button\r\n                    key={toolItem.id}\r\n                    onClick={() => {\r\n                      console.log('üîß Tool changed to:', toolItem.id);\r\n                      setTool(toolItem.id);\r\n                    }}\r\n                    className={`p-2 rounded border flex items-center justify-center ${\r\n                      tool === toolItem.id\r\n                        ? 'bg-blue-100 border-blue-500 text-blue-700'\r\n                        : 'border-gray-300 hover:bg-gray-50'\r\n                    }`}\r\n                    title={toolItem.name}\r\n                  >\r\n                    <Icon className=\"h-4 w-4\" />\r\n                  </button>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Color Selection */}\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"text-xs font-medium text-gray-600\">Color</h4>\r\n            <div className=\"flex flex-wrap gap-1\">\r\n              {colors.map((colorOption) => (\r\n                <button\r\n                  key={colorOption}\r\n                  onClick={() => setColor(colorOption)}\r\n                  className={`w-6 h-6 rounded border-2 ${\r\n                    color === colorOption ? 'border-gray-800' : 'border-gray-300'\r\n                  }`}\r\n                  style={{ backgroundColor: colorOption }}\r\n                />\r\n              ))}\r\n            </div>\r\n            <input\r\n              type=\"color\"\r\n              value={color}\r\n              onChange={(e) => setColor(e.target.value)}\r\n              className=\"w-full h-8 rounded border\"\r\n            />\r\n          </div>\r\n\r\n          {/* Stroke Width */}\r\n          <div className=\"space-y-2\">\r\n            <h4 className=\"text-xs font-medium text-gray-600\">Stroke Width</h4>\r\n            <input\r\n              type=\"range\"\r\n              min=\"1\"\r\n              max=\"10\"\r\n              value={strokeWidth}\r\n              onChange={(e) => setStrokeWidth(parseInt(e.target.value))}\r\n              className=\"w-full\"\r\n            />\r\n            <div className=\"text-xs text-gray-600\">{strokeWidth}px</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Show Tools Button (when hidden) */}\r\n      {!showTools && (\r\n        <button\r\n          onClick={() => setShowTools(true)}\r\n          className=\"fixed left-4 top-1/2 transform -translate-y-1/2 bg-white rounded-lg shadow-lg p-2 z-40\"\r\n          title=\"Show Drawing Tools\"\r\n        >\r\n          <Palette className=\"h-5 w-5\" />\r\n        </button>\r\n      )}\r\n\r\n      {/* Drawing Preview Overlay */}\r\n      {isDrawing && canvasRect && (\r\n        <svg\r\n          ref={svgRef}\r\n          className=\"fixed pointer-events-none z-30\"\r\n          style={{ \r\n            left: canvasRect.left,\r\n            top: canvasRect.top,\r\n            width: canvasRect.width,\r\n            height: canvasRect.height\r\n          }}\r\n        >\r\n          {renderCurrentDrawing()}\r\n        </svg>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DrawingTools;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}